<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Professional personal brand website showcasing expertise, services, and solutions.">
  <title>Home | My Personal Brand</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="https://detourdev.com/assets/img/favicion.png">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&family=Raleway:wght@300;400;500;600&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

  <!-- Swiper CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css">

  <!-- Slick Carousel CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="assets/css/plugins.css">
  <link rel="stylesheet" href="assets/css/style.css">
  <link rel="stylesheet" href="assets/css/menu-responsive.css">
  <link rel="stylesheet" href="assets/css/accordion.css">

  <style>
    .text-logo {
      font-family: 'Montserrat', sans-serif;
      font-size: 24px;
      font-weight: 700;
      color: var(--text-color);
    }
    .customize-banner {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--accent-color);
      opacity: 0.5;
      color: #000;
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      z-index: 9999;
      display: flex;
      align-items: center;
      gap: 10px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      transition: transform 0.3s ease;
    }
    .customize-banner:hover {
      transform: translateY(-3px);
    }
    .customize-banner i {
      font-size: 18px;
    }

    /* Bottom-left action buttons container */
    .bottom-left-actions {
      position: fixed;
      bottom: 20px;
      left: 20px;
      display: flex;
      flex-direction: row;
      gap: 10px;
      z-index: 9999;
    }

    /* QR Code Button */
    .qr-code-btn {
      background: var(--accent-color);
      opacity: 0.5;
      color: #000;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      font-size: 20px;
      font-weight: 500;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      transition: transform 0.3s ease, opacity 0.3s ease;
      cursor: pointer;
      border: none;
      text-decoration: none;
    }
    .qr-code-btn:hover {
      transform: translateY(-3px);
      opacity: 0.8;
    }

    /* Resume PDF Button */
    .resume-pdf-btn {
      background: var(--accent-color);
      opacity: 0.5;
      color: #000;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      font-size: 20px;
      font-weight: 500;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      transition: transform 0.3s ease, opacity 0.3s ease;
      cursor: pointer;
      border: none;
      text-decoration: none;
    }
    .resume-pdf-btn:hover {
      transform: translateY(-3px);
      opacity: 0.8;
    }

    /* AI Chat Button */
    .ai-chat-btn {
      background: var(--accent-color);
      opacity: 0.5;
      color: #000;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      font-size: 20px;
      font-weight: 500;
      display: none;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      transition: transform 0.3s ease, opacity 0.3s ease;
      cursor: pointer;
      border: none;
      text-decoration: none;
    }
    .ai-chat-btn:hover {
      transform: translateY(-3px);
      opacity: 0.8;
    }

    /* AI Chat Panel */
    .ai-chat-panel {
      display: none;
      position: fixed;
      bottom: 80px;
      left: 20px;
      width: 360px;
      height: 480px;
      background: #1a1a2e;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
      z-index: 10000;
      flex-direction: column;
      overflow: hidden;
      font-family: 'Montserrat', sans-serif;
    }
    .ai-chat-panel.active {
      display: flex;
    }
    .ai-chat-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 18px;
      background: #16213e;
      color: #fff;
      font-size: 15px;
      font-weight: 600;
    }
    .ai-chat-header button {
      background: none;
      border: none;
      color: #fff;
      font-size: 22px;
      cursor: pointer;
      line-height: 1;
      opacity: 0.7;
      transition: opacity 0.2s;
    }
    .ai-chat-header button:hover {
      opacity: 1;
    }
    .ai-chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .ai-chat-bubble {
      max-width: 85%;
      padding: 10px 14px;
      border-radius: 12px;
      font-size: 13px;
      line-height: 1.5;
      word-wrap: break-word;
    }
    .ai-chat-bubble.assistant {
      background: #16213e;
      color: #e0e0e0;
      align-self: flex-start;
      border-bottom-left-radius: 4px;
    }
    .ai-chat-bubble.user {
      background: var(--accent-color, #8c7a5a);
      color: #000;
      align-self: flex-end;
      border-bottom-right-radius: 4px;
    }
    .ai-chat-typing {
      display: none;
      align-self: flex-start;
      padding: 10px 14px;
      background: #16213e;
      border-radius: 12px;
      border-bottom-left-radius: 4px;
      font-size: 13px;
      color: #888;
    }
    .ai-chat-typing.active {
      display: block;
    }
    .ai-chat-typing span {
      animation: typingDots 1.4s infinite;
    }
    .ai-chat-typing span:nth-child(2) { animation-delay: 0.2s; }
    .ai-chat-typing span:nth-child(3) { animation-delay: 0.4s; }
    @keyframes typingDots {
      0%, 60%, 100% { opacity: 0.3; }
      30% { opacity: 1; }
    }
    .ai-chat-input {
      display: flex;
      padding: 12px;
      gap: 8px;
      background: #0f0f23;
      border-top: 1px solid rgba(255,255,255,0.05);
    }
    .ai-chat-input input {
      flex: 1;
      background: #1a1a2e;
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      padding: 10px 14px;
      color: #fff;
      font-size: 13px;
      font-family: inherit;
      outline: none;
    }
    .ai-chat-input input::placeholder {
      color: #666;
    }
    .ai-chat-input input:focus {
      border-color: var(--accent-color, #8c7a5a);
    }
    .ai-chat-input button {
      background: var(--accent-color, #8c7a5a);
      border: none;
      border-radius: 8px;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: #000;
      font-size: 14px;
      transition: opacity 0.2s;
    }
    .ai-chat-input button:hover {
      opacity: 0.8;
    }
    @media (max-width: 480px) {
      .ai-chat-panel {
        width: 100%;
        height: 100%;
        left: 0;
        bottom: 0;
        border-radius: 0;
      }
    }

    /* QR Code Modal */
    .qr-modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      z-index: 10000;
      align-items: center;
      justify-content: center;
    }
    .qr-modal-overlay.active {
      display: flex;
    }
    .qr-modal {
      background: #fff;
      border-radius: 16px;
      padding: 32px;
      text-align: center;
      max-width: 320px;
      width: 90%;
      position: relative;
      box-shadow: 0 20px 60px rgba(0,0,0,0.4);
    }
    .qr-modal-close {
      position: absolute;
      top: 12px;
      right: 16px;
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #333;
      line-height: 1;
    }
    .qr-modal h4 {
      margin: 0 0 8px 0;
      font-size: 18px;
      color: #000;
    }
    .qr-modal p {
      margin: 0 0 20px 0;
      font-size: 13px;
      color: #666;
    }
    #qrCodeCanvas {
      display: flex;
      justify-content: center;
    }
    #qrCodeCanvas img,
    #qrCodeCanvas canvas {
      display: block;
      margin: 0 auto;
    }
  </style>
</head>
<body>
  <!-- Page Loader -->
  <div class="dsn-loader">
    <div class="loading-circle"></div>
  </div>

  <!-- Custom Cursor -->
  <div class="cursor"></div>
  <div class="cursor-inner"></div>

  <!-- Header -->
  <header>
    <div class="main-navigation">
      <a href="index.html" class="logo" data-template="logo">
        <span class="text-logo" data-template="siteName">YourBrand</span>
      </a>

      <nav class="desktop-nav">
        <a href="index.html" class="active">Home</a>
        <a href="about.html">About</a>
        <a href="services.html">Services</a>
        <a href="solutions.html">Solutions</a>
        <a href="process.html">Process</a>
        <a href="contact.html">Contact</a>
        <a href="audit.html" class="nav-cta">Book An Audit</a>
      </nav>

      <div class="nav-toggle">
        <div class="hamburger">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </div>
  </header>

  <!-- Mobile Menu -->
  <div class="mobile-menu">
    <div class="mobile-menu-inner">
      <nav>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="services.html">Services</a></li>
          <li><a href="solutions.html">Solutions</a></li>
          <li><a href="process.html">Process</a></li>
          <li><a href="contact.html">Contact</a></li>
          <li><a href="audit.html">Book A Call</a></li>
        </ul>
      </nav>
      <div class="mobile-menu-social" data-template="socialLinks">
        <a href="#"><i class="fab fa-linkedin-in"></i></a>
        <a href="#"><i class="fab fa-twitter"></i></a>
        <a href="#"><i class="fab fa-github"></i></a>
      </div>
    </div>
  </div>

  <!-- Hero Slider Section -->
  <section class="hero-section">
    <div class="hero-slider swiper">
      <div class="swiper-wrapper" data-template="heroSlides">
        <!-- Populated from config.js -->
      </div>

      <!-- Slider Navigation -->
      <div class="hero-slider-nav">
        <button class="slider-nav-btn prev"><i class="fas fa-arrow-left"></i></button>
        <button class="slider-nav-btn next"><i class="fas fa-arrow-right"></i></button>
      </div>

      <!-- Progress Bar -->
      <div class="slider-progress">
        <div class="slider-progress-bar"></div>
      </div>
    </div>

    <!-- Scroll Indicator -->
    <div class="scroll-indicator">
      <span>Scroll</span>
      <div class="mouse"></div>
    </div>
  </section>

  <!-- Intro Section -->
  <section class="section-padding">
    <div class="container">
      <div class="intro-section">
        <div class="intro-content mgc-left">
          <span class="section-header sub-heading">About Me</span>
          <h2>Solutions for Modern Challenges</h2>
          <div data-template="shortBio">
            <!-- Populated from config.js -->
          </div>
          <a href="about.html" class="btn" style="margin-top: 20px;">More About Me</a>
        </div>
        <div class="intro-image mgc-right">
          <img src="" alt="About" data-template-image="aboutImage">
          <div class="image-overlay">
            <h3 data-template="yearsExperience"><!-- config.js --></h3>
            <p>Years Experience</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Services Accordion Section -->
  <section class="section-padding bg-darker">
    <div class="container">
      <div class="section-header text-center mgc-up">
        <span class="sub-heading">What I Do</span>
        <h2>Services & Expertise</h2>
        <p>Comprehensive services tailored to your needs</p>
      </div>

      <div class="dsn-accordion services-accordion mgc-up" data-delay="200" data-template="servicesAccordion">
        <!-- Populated from config.js -->
      </div>
    </div>
  </section>

  <!-- Parallax Image Break -->
  <section class="image-section" data-overlay="3">
    <div class="bg-image" style="background-image: none;" data-template-image="parallaxImage1"></div>
  </section>

  <!-- Focus Areas Section (Where We Can Help) -->
  <section class="section-padding focus-areas-section">
    <div class="container">
      <div class="section-header mgc-up" data-template="focusAreasHeader">
        <span class="sub-heading">Where We Can Help</span>
        <h2>Areas of Expertise</h2>
        <p class="focus-tagline">Specialized guidance available • On-site or remote • Tailored to your needs</p>
      </div>

      <div class="focus-areas-grid mgc-up" data-delay="200" data-template="focusAreas">
        <!-- Populated from config.js -->
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="section-padding bg-darker">
    <div class="container">
      <div class="text-center">
        <h2 class="mgc-up">Ready to Get Started?</h2>
        <p class="mgc-up" data-delay="100" style="max-width: 600px; margin: 20px auto 40px;" data-pronoun data-pronoun-person="Let's discuss how I can help you achieve your goals." data-pronoun-company="Let's discuss how we can help you achieve your goals.">Let's discuss how I can help you achieve your goals.</p>
        <a href="audit.html" class="btn btn-primary mgc-up" data-delay="200">Book A Free Call</a>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-logo">
          <div data-template="logo">
            <span class="text-logo" data-template="siteName">YourBrand</span>
          </div>
          <p data-template="footerTagline">Expert helping you leverage the right tools for growth and efficiency.</p>
        </div>

        <div class="footer-nav">
          <h5>Quick Links</h5>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="services.html">Services</a></li>
            <li><a href="solutions.html">Solutions</a></li>
            <li><a href="process.html">Process</a></li>
          </ul>
        </div>

        <div class="footer-contact">
          <h5>Get In Touch</h5>
          <p>Email: <a href="#" data-template="emailLink">hello@yourdomain.com</a></p>
          <p data-template="location">Your Location</p>
          <div class="footer-social" data-template="socialLinks">
            <a href="#"><i class="fab fa-linkedin-in"></i></a>
            <a href="#"><i class="fab fa-twitter"></i></a>
            <a href="#"><i class="fab fa-github"></i></a>
          </div>
        </div>
      </div>

      <div class="footer-bottom">
        <p data-template="copyright">&copy; 2024 YourBrand. All Rights Reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Bottom-left Action Buttons -->
  <div class="bottom-left-actions">
    <button class="qr-code-btn" id="qrCodeBtn" title="Share via QR Code">
      <i class="fas fa-qrcode"></i>
    </button>
    <button class="resume-pdf-btn" id="resumePdfBtn" title="Download Resume PDF">
      <i class="fas fa-file-pdf"></i>
    </button>
    <button class="ai-chat-btn" id="aiChatBtn" style="display:none" title="Ask AI">
      <i class="fas fa-comments"></i>
    </button>
  </div>

  <!-- AI Chat Panel -->
  <div class="ai-chat-panel" id="aiChatPanel">
    <div class="ai-chat-header">
      <span>Chat with AI</span>
      <button id="aiChatClose">&times;</button>
    </div>
    <div class="ai-chat-messages" id="aiChatMessages">
      <div class="ai-chat-typing" id="aiChatTyping">
        <span>.</span><span>.</span><span>.</span>
      </div>
    </div>
    <div class="ai-chat-input">
      <input type="text" id="aiChatInput" placeholder="Ask a question..." maxlength="1000">
      <button id="aiChatSend"><i class="fas fa-paper-plane"></i></button>
    </div>
  </div>

  <!-- QR Code Modal -->
  <div class="qr-modal-overlay" id="qrModalOverlay">
    <div class="qr-modal">
      <button class="qr-modal-close" id="qrModalClose">&times;</button>
      <h4>Scan to Connect</h4>
      <p>Point your camera to save my info</p>
      <div id="qrCodeCanvas"></div>
    </div>
  </div>

  <!-- Customize Banner -->
  <a href="questionnaire.html" class="customize-banner">
    <i class="fas fa-magic"></i>
    Customize This Site
  </a>

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
  <script src="assets/js/config.js"></script>
  <script src="assets/js/plugins.js"></script>
  <script src="assets/js/mgc-grid.js"></script>
  <script src="assets/js/template-engine.js"></script>
  <script src="assets/js/custom.js"></script>

  <!-- Analytics -->
  <script src="assets/js/analytics.js"></script>

  <!-- QR Code Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

  <!-- jsPDF Library -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.2/dist/jspdf.umd.min.js"></script>
  <script>
    (function() {
      var btn = document.getElementById('qrCodeBtn');
      var overlay = document.getElementById('qrModalOverlay');
      var closeBtn = document.getElementById('qrModalClose');
      var container = document.getElementById('qrCodeCanvas');
      var generated = false;

      function generateQR() {
        if (generated) return;
        new QRCode(container, {
          text: window.location.href,
          width: 220,
          height: 220,
          colorDark: '#000000',
          colorLight: '#ffffff',
          correctLevel: QRCode.CorrectLevel.H
        });
        generated = true;
      }

      btn.addEventListener('click', function() {
        overlay.classList.add('active');
        generateQR();
      });

      closeBtn.addEventListener('click', function() {
        overlay.classList.remove('active');
      });

      overlay.addEventListener('click', function(e) {
        if (e.target === overlay) overlay.classList.remove('active');
      });

      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') overlay.classList.remove('active');
      });
    })();
  </script>

  <!-- Resume PDF Generator -->
  <script>
    (function() {
      var btn = document.getElementById('resumePdfBtn');

      function getConfig() {
        // Use the same resolved config the template engine uses
        if (window.TemplateEngine && window.TemplateEngine.config) {
          return window.TemplateEngine.config;
        }
        // Fallback: try localStorage, then default
        try {
          var stored = localStorage.getItem('siteConfig');
          if (stored) return JSON.parse(stored);
        } catch (e) {}
        if (window.siteConfig) return window.siteConfig;
        return null;
      }

      function loadImageAsDataURL(url) {
        return new Promise(function(resolve) {
          if (!url) { resolve(null); return; }
          var img = new Image();
          img.crossOrigin = 'anonymous';
          img.onload = function() {
            try {
              var canvas = document.createElement('canvas');
              canvas.width = img.naturalWidth;
              canvas.height = img.naturalHeight;
              canvas.getContext('2d').drawImage(img, 0, 0);
              resolve({ dataURL: canvas.toDataURL('image/jpeg', 0.85), w: img.naturalWidth, h: img.naturalHeight });
            } catch (e) { resolve(null); }
          };
          img.onerror = function() { resolve(null); };
          img.src = url;
        });
      }

      function generateResumePDF() {
        var config = getConfig();
        if (!config) { alert('Site configuration not found.'); return; }
        var jsPDF = window.jspdf && window.jspdf.jsPDF;
        if (!jsPDF) { alert('PDF library failed to load. Please refresh and try again.'); return; }

        var images = config.images || {};
        var aboutImageUrl = images.aboutImage || '';

        loadImageAsDataURL(aboutImageUrl).then(function(imgData) {
          buildPDF(config, jsPDF, imgData);
        });
      }

      function buildPDF(config, jsPDF, photoData) {
        var doc = new jsPDF({ unit: 'mm', format: 'a4' });
        var pageW = 210;
        var margin = 18;
        var contentW = pageW - margin * 2;
        var y = 18;
        var lineH = 5.5;

        // Photo dimensions for header
        var photoSize = 32; // mm square
        var photoX = pageW - margin - photoSize;
        var headerTextW = contentW - (photoData ? photoSize + 6 : 0);

        // Colors
        var accent = [140, 120, 90];
        var dark = [30, 30, 30];
        var muted = [120, 120, 120];

        function checkPage(needed) {
          if (y + needed > 280) { doc.addPage(); y = 18; }
        }

        function drawSectionLine() {
          doc.setDrawColor(accent[0], accent[1], accent[2]);
          doc.setLineWidth(0.4);
          doc.line(margin, y, pageW - margin, y);
          y += 4;
        }

        function sectionHeading(text) {
          checkPage(14);
          drawSectionLine();
          doc.setFont('helvetica', 'bold');
          doc.setFontSize(11);
          doc.setTextColor(accent[0], accent[1], accent[2]);
          doc.text(text.toUpperCase(), margin, y);
          y += 7;
        }

        function bodyText(text, opts) {
          opts = opts || {};
          doc.setFont('helvetica', opts.bold ? 'bold' : 'normal');
          doc.setFontSize(opts.size || 9.5);
          doc.setTextColor(opts.color ? opts.color[0] : dark[0], opts.color ? opts.color[1] : dark[1], opts.color ? opts.color[2] : dark[2]);
          var lines = doc.splitTextToSize(text, opts.width || contentW);
          checkPage(lines.length * lineH + 2);
          doc.text(lines, opts.x || margin, y);
          y += lines.length * lineH;
        }

        var p = config.personal || {};
        var c = config.contact || {};

        // --- PHOTO (top-right) ---
        if (photoData) {
          var aspect = photoData.w / photoData.h;
          var imgW = photoSize;
          var imgH = photoSize / aspect;
          if (imgH > photoSize) { imgH = photoSize; imgW = photoSize * aspect; }
          var imgX = photoX + (photoSize - imgW) / 2;
          doc.addImage(photoData.dataURL, 'JPEG', imgX, y - 2, imgW, imgH);
        }

        // --- HEADER ---
        var headerStartY = y;
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(24);
        doc.setTextColor(dark[0], dark[1], dark[2]);
        doc.text(p.name || 'Name', margin, y, { maxWidth: headerTextW });
        y += 8;

        if (p.title) {
          doc.setFont('helvetica', 'normal');
          doc.setFontSize(13);
          doc.setTextColor(accent[0], accent[1], accent[2]);
          doc.text(p.title, margin, y, { maxWidth: headerTextW });
          y += 6;
        }
        if (p.tagline) {
          doc.setFont('helvetica', 'italic');
          doc.setFontSize(10);
          doc.setTextColor(muted[0], muted[1], muted[2]);
          doc.text(p.tagline, margin, y, { maxWidth: headerTextW });
          y += 6;
        }

        // Ensure y is past the photo if the text was shorter
        if (photoData) {
          var photoBottom = headerStartY - 2 + photoSize + 2;
          if (y < photoBottom) y = photoBottom;
        }
        y += 2;

        // --- CONTACT ---
        var contactParts = [];
        if (c.email) contactParts.push(c.email);
        if (c.phone) contactParts.push(c.phone);
        if (c.website) contactParts.push(c.website);
        if (p.location) contactParts.push(p.location);

        if (contactParts.length) {
          doc.setFont('helvetica', 'normal');
          doc.setFontSize(9);
          doc.setTextColor(muted[0], muted[1], muted[2]);
          doc.text(contactParts.join('  |  '), margin, y);
          y += 6;
        }

        // --- SOCIAL ---
        var social = config.social || {};
        var socialParts = [];
        Object.keys(social).forEach(function(key) {
          if (social[key]) socialParts.push(key.charAt(0).toUpperCase() + key.slice(1) + ': ' + social[key]);
        });
        if (socialParts.length) {
          doc.setFont('helvetica', 'normal');
          doc.setFontSize(8);
          doc.setTextColor(muted[0], muted[1], muted[2]);
          var socialLines = doc.splitTextToSize(socialParts.join('  |  '), contentW);
          doc.text(socialLines, margin, y);
          y += socialLines.length * 4 + 2;
        }

        y += 2;

        // --- BIO ---
        if (p.shortBio) {
          sectionHeading('About');
          bodyText(p.shortBio);
          y += 3;
        }

        // --- EXPERIENCE / TIMELINE ---
        var timeline = config.timeline;
        if (timeline && timeline.length) {
          sectionHeading('Experience');
          timeline.forEach(function(item) {
            checkPage(18);
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(10);
            doc.setTextColor(dark[0], dark[1], dark[2]);
            doc.text(item.title || '', margin, y);

            if (item.period) {
              doc.setFont('helvetica', 'normal');
              doc.setFontSize(9);
              doc.setTextColor(muted[0], muted[1], muted[2]);
              doc.text(item.period, pageW - margin, y, { align: 'right' });
            }
            y += lineH;

            if (item.description) {
              bodyText(item.description, { color: muted });
            }
            y += 3;
          });
        }

        // --- SERVICES / SKILLS ---
        var services = config.services;
        if (services && services.length) {
          sectionHeading('Services & Skills');
          services.forEach(function(svc) {
            checkPage(12);
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(9.5);
            doc.setTextColor(dark[0], dark[1], dark[2]);
            doc.text(svc.title || '', margin, y);
            y += lineH;

            if (svc.shortDesc) {
              bodyText(svc.shortDesc, { color: muted, size: 9 });
            }
            y += 2;
          });
        }

        // --- INDUSTRIES SERVED ---
        var solutions = config.solutions;
        if (solutions && solutions.length) {
          sectionHeading('Industries Served');
          solutions.forEach(function(sol) {
            checkPage(12);
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(9.5);
            doc.setTextColor(dark[0], dark[1], dark[2]);
            doc.text(sol.title || '', margin, y);
            y += lineH;

            if (sol.description) {
              bodyText(sol.description, { color: muted, size: 9 });
            }
            y += 2;
          });
        }

        // --- PHILOSOPHY / VALUES ---
        var philosophy = config.philosophy;
        if (philosophy && philosophy.length) {
          sectionHeading('Values & Philosophy');
          philosophy.forEach(function(val) {
            checkPage(12);
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(9.5);
            doc.setTextColor(dark[0], dark[1], dark[2]);
            doc.text(val.title || '', margin, y);
            y += lineH;

            if (val.description) {
              bodyText(val.description, { color: muted, size: 9 });
            }
            y += 2;
          });
        }

        // --- TESTIMONIALS ---
        var testimonials = config.testimonials;
        if (testimonials && testimonials.length) {
          sectionHeading('Testimonials');
          testimonials.forEach(function(t) {
            checkPage(20);
            doc.setFont('helvetica', 'italic');
            doc.setFontSize(9.5);
            doc.setTextColor(dark[0], dark[1], dark[2]);
            var quoteLines = doc.splitTextToSize('"' + (t.quote || '') + '"', contentW);
            checkPage(quoteLines.length * lineH + 8);
            doc.text(quoteLines, margin, y);
            y += quoteLines.length * lineH + 1;

            var attribution = '— ' + (t.author || '');
            if (t.role) attribution += ', ' + t.role;
            if (t.company) attribution += ', ' + t.company;
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(8.5);
            doc.setTextColor(muted[0], muted[1], muted[2]);
            doc.text(attribution, margin, y);
            y += lineH + 3;
          });
        }

        // --- DOWNLOAD ---
        var firstName = (p.firstName || 'Resume').replace(/\s+/g, '_');
        var lastName = (p.lastName || '').replace(/\s+/g, '_');
        var filename = lastName ? firstName + '_' + lastName + '_Resume.pdf' : firstName + '_Resume.pdf';
        doc.save(filename);
      }

      btn.addEventListener('click', generateResumePDF);
    })();
  </script>

  <!-- AI Chat Widget -->
  <script>
    (function() {
      var API_BASE = 'https://rebrandmyself.net/api/experts';
      var chatBtn = document.getElementById('aiChatBtn');
      var panel = document.getElementById('aiChatPanel');
      var closeBtn = document.getElementById('aiChatClose');
      var messagesEl = document.getElementById('aiChatMessages');
      var inputEl = document.getElementById('aiChatInput');
      var sendBtn = document.getElementById('aiChatSend');
      var typingEl = document.getElementById('aiChatTyping');
      var expertData = null;
      var history = [];
      var sending = false;
      var conversationId = null;

      // Determine site base URL
      var siteBase = window.location.origin;
      if (window.location.hostname.endsWith('.github.io')) {
        var repo = window.location.pathname.split('/').filter(Boolean)[0];
        if (repo) siteBase += '/' + repo;
      }

      // Check if expert exists for this site
      fetch(API_BASE + '/check?site=' + encodeURIComponent(siteBase))
        .then(function(res) {
          if (!res.ok) throw new Error('Not found');
          return res.json();
        })
        .then(function(data) {
          expertData = data;
          chatBtn.style.display = 'flex';
        })
        .catch(function() {
          // No expert — don't show chat button
        });

      // Toggle panel
      chatBtn.addEventListener('click', function() {
        var isOpen = panel.classList.toggle('active');
        if (isOpen && messagesEl.querySelectorAll('.ai-chat-bubble').length === 0) {
          addBubble('assistant', 'Ask me anything about ' + (expertData ? expertData.name : 'this consultant') + '!');
        }
        if (isOpen) inputEl.focus();
      });

      closeBtn.addEventListener('click', function() {
        panel.classList.remove('active');
      });

      function linkify(text) {
        // Escape HTML first to prevent XSS, then convert URLs to links
        var escaped = text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
        return escaped.replace(/(https?:\/\/[^\s<]+)/g, '<a href="$1" target="_blank" rel="noopener noreferrer" style="color:#c5a47e;text-decoration:underline;">$1</a>');
      }

      function addBubble(role, text) {
        var div = document.createElement('div');
        div.className = 'ai-chat-bubble ' + role;
        div.innerHTML = linkify(text);
        messagesEl.insertBefore(div, typingEl);
        messagesEl.scrollTop = messagesEl.scrollHeight;
      }

      function sendMessage() {
        var text = inputEl.value.trim();
        if (!text || sending) return;

        addBubble('user', text);
        inputEl.value = '';
        sending = true;
        typingEl.classList.add('active');
        messagesEl.scrollTop = messagesEl.scrollHeight;

        fetch(API_BASE + '/site-chat', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            site: siteBase,
            message: text,
            history: history.slice(-10),
            conversationId: conversationId
          })
        })
        .then(function(res) { return res.json(); })
        .then(function(data) {
          typingEl.classList.remove('active');
          sending = false;
          var reply = data.reply || data.error || 'Sorry, something went wrong.';
          addBubble('assistant', reply);
          history.push({ role: 'user', content: text });
          history.push({ role: 'assistant', content: reply });
          if (data.conversationId) conversationId = data.conversationId;
        })
        .catch(function() {
          typingEl.classList.remove('active');
          sending = false;
          addBubble('assistant', 'Sorry, I could not connect. Please try again.');
        });

        // Track analytics
        if (typeof window._rmAnalytics === 'function') {
          window._rmAnalytics('ai_chat_message');
        }
      }

      sendBtn.addEventListener('click', sendMessage);
      inputEl.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') sendMessage();
      });
    })();
  </script>
</body>
</html>
